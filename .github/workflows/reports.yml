# SPDX-License-Identifier: Apache-2.0
# Licensed to the Ed-Fi Alliance under one or more agreements.
# The Ed-Fi Alliance licenses this file to you under the Apache License, Version 2.0.
# See the LICENSE and NOTICES files in the project root for more information.

name: Reports
on:
  workflow_run:
    workflows: ["Test"]
    types:
      - completed

jobs:
  report:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        tests:
          [
            { name: "Unit Test Report", file: "unit-tests/junit.xml" },
            {
              name: "Integration Test Report",
              file: "integration-tests/junit.xml",
            },
            { name: "System Test Report", file: "system-tests/junit.xml" },
            {
              name: "Mongo End To End Tests",
              file: "Mongo-e2e-tests/junit.xml",
            },
            {
              name: "PostgreSQL End To End Tests",
              file: "PGSQL-e2e-tests/junit.xml",
            },
          ]

    steps:
      - name: ${{ matrix.name }}
        uses: dorny/test-reporter@c9b3d0e2bd2a4e96aaf424dbaa31c46b42318226 # v1.6.0
        with:
          name: ${{ matrix.tests.name }}
          artifact: "test-results"
          path: ${{ matrix.tests.file }}
          reporter: jest-junit
